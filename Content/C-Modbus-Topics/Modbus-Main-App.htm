<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="Modbus RTU" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Application On The Main Device Side</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1>Application On The Main Device Side</h1>
                                        <p>Depending on whether the application will be implemented using the built-in COM port or the EL terminal, you should declare the appropriate function block in the application.</p>
                                        <ul>
                                            <li>
                                                <p>ModbusRtuMaster_PcCom – for built-in COM port.</p>
                                            </li>
                                            <li>
                                                <p>ModbusRtuMaster_KL6x22B – for EL6022 terminal.</p>
                                            </li>
                                        </ul>
                                        <p style="text-align: center;" data-mc-target-name="Sample declaration of Main device function block">
                                            <img src="../Resources/Images/modbus-declare.png" title="Sample declaration of Main device function block" alt="Sample declaration of Main device function block" style="border-left-style: solid;border-left-width: 1px;border-left-color: ;border-right-style: solid;border-right-width: 1px;border-right-color: ;border-top-style: solid;border-top-width: 1px;border-top-color: ;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: ;" />
                                        </p>
                                        <p class="image-desc" data-mc-xref-target-name="Sample_declaration_of_Main_device_function_block"><a name="Sample_declaration_of_Main_device_function_block" data-mc-generated-bookmark="ListOf"></a>Sample declaration of Main device function block</p>
                                        <p style="text-align: center;">
                                            <img src="../Resources/Images/Modbus-fb.png" title="Sample call of Main device function block" alt="Sample call of Main device function block" style="border-left-style: solid;border-left-width: 0px;border-left-color: ;border-right-style: solid;border-right-width: 0px;border-right-color: ;border-top-style: solid;border-top-width: 0px;border-top-color: ;border-bottom-style: solid;border-bottom-width: 0px;border-bottom-color: ;" data-mc-target-name="Sample call of Main device function block" />
                                        </p>
                                        <p class="image-desc" data-mc-xref-target-name="Sample_call_of_Main_device_function_block"><a name="Sample_call_of_Main_device_function_block" data-mc-generated-bookmark="ListOf"></a>Sample call of Main device function block</p>
                                        <p>Description of inputs and outputs of the function block (regardless of the chosen block, the only difference is the size of the communication buffer):</p>
                                        <table style="mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;margin-left: 0;margin-right: auto;caption-side: top;" class="TableStyle-Alternate-Row-Color" cellspacing="21">
                                            <caption style="text-align: left;">
                                                <label data-mc-xref-target-name="Inputs_description_of_main_device_function_block"><a name="Inputs_description_of_main_device_function_block" data-mc-generated-bookmark="ListOf"></a> Inputs description of main device function block</label>
                                            </caption>
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Input name</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Input type</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Default value</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Range</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UnitID</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">1..247</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Includes the address of the secondary station from which the data is to be read/written.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Quantity</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">WORD</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">1..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Specifies the number of registers (2 bytes) to be read/written in the secondary device.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">MBAddr</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">WORD</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Indicates the address of the first register from which the data will be read/written.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">cbLength</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">1..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Specifies the number of bytes to be read/written. (Quantity*2).</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">pMemoryAddr</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">DWORD</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0..2147483647</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Indicates the address where the read data should be stored in the program, or the address of the register from which the data to be written is retrieved.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Execute</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">BOOL</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">FALSE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">TRUE/FALSE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">A rising edge on this input starts the execution of the current command.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">Timeout</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">TIME</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">T#5s</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">T#0s..T#50d</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body1">The timeout period for receiving a response from the secondary device. If there is no response within this time, the block returns an error.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>&#160;</p>
                                        <table style="mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;margin-left: 0;margin-right: auto;caption-side: top;width: 100%;" class="TableStyle-Alternate-Row-Color" cellspacing="21">
                                            <caption style="text-align: left;">
                                                <label data-mc-xref-target-name="Outputs_description_of_main_device_function_block"><a name="Outputs_description_of_main_device_function_block" data-mc-generated-bookmark="ListOf"></a> Outputs description of main device function block</label>
                                            </caption>
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Output name</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Output type</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Default value</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Range</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Busy</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">BOOL</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">FALSE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">FALSE/TRUE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Indicates the status of the block. When it is True, it means that the block is busy executing the current task and will not respond to other commands.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Error</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">BOOL</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">FALSE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">FALSE/TRUE</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Informs about the occurrence of an error (value true) or its absence (value false).</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">ErrorID</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Error code.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">cbRead</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body2">Returns the number of transmitted bytes.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>On the application side, the function block is only declared and is not called itself. Instead, the function block's individual actions are invoked depending on which communication function is to be performed.</p>
                                        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;margin-left: 0;margin-right: auto;caption-side: top;" class="TableStyle-Alternate-Row-Color" cellspacing="21">
                                            <caption style="text-align: left;">
                                                <label data-mc-xref-target-name="Available_modbus_functions"><a name="Available_modbus_functions" data-mc-generated-bookmark="ListOf"></a> Available modbus functions</label>
                                            </caption>
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" style="width: 209px;" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Function name</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Function number</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">ReadCoils</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">1</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Reads digital outputs from the secondary device.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">ReadInputStatus</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">2</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Reads digital inputs from the secondary device.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">ReadRegs</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">3</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Reads 2-byte output registers from the secondary device.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">ReadInputRegs</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">4</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Reads 2-byte input registers from the secondary device.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                                                        <p>WriteSingleCoil</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                                                        <p class="table-text">5</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">
                                                        <p>Writes a single digital output in the secondary device.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                                                        <p>WriteSingleRegister</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                                                        <p class="table-text">6</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">
                                                        <p>Writes a single 2-byte register in the secondary device.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                                                        <p>Diagnostics</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                                                        <p class="table-text">8</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">
                                                        <p>Reads diagnostic data from the secondary device.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                                                        <p>WriteMultipleCoils</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                                                        <p class="table-text">15</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">
                                                        <p>Writes multiple digital outputs in the secondary device.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">WriteRegs</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">16</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body1">Writes multiple 2-byte registers in the secondary device.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>Example of variable declaration and code implementation for implementing function 3:</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetCaption">
                                                <p>Modbus Function 3 </p>
                                            </div>
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="True"><pre><span class="codeSnippetLineNumbers" style="border-right: #AAA 2px solid;" aria-hidden="true">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</span><code>PROGRAM ModbusMaster&#160;<br />VAR<br />&#160;&#160;&#160;&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ModbusRTUMaster_PCCom;<br />&#160;&#160;&#160;&#160;State&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: WORD;<br />&#160;&#160;&#160;&#160;bError&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: BOOL;<br />&#160;&#160;&#160;&#160;arrRegs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ARRAY [0..6] OF WORD;<br />&#160;&#160;&#160;&#160;nId&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: BYTE:=10;<br />END_VAR<br /><br />CASE State OF<br />&#160;&#160;&#160;&#160;0:(*Initialization*)&#160;<br />&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MB(Execute:= FALSE);&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;State:= State+10;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;10: (*Function 3 (Read Holding Registers) *)<br />&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MB.ReadRegs(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;UnitID:=nId ,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//slave address<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Quantity:=7 ,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//number of 2-byte registers to read&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MBAddr:=0,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//address of the first register to read&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cbLength:= 14,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//number of bytes to read - Quantity*2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;pMemoryAddr:=ADR(arrRegs) , //address to store read data&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Execute:= TRUE,&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;timeout := T#1s,&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Error=&gt;bError&#160;&#160;);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF NOT MB.BUSY AND NOT bError THEN<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;State:=0;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MB.ReadRegs(Execute:= FALSE);&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSIF bError THEN<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;State := 999;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MB.ReadRegs(Execute:= FALSE);&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;999:(*Error handling*)&#160;<br />&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MB(Execute:= FALSE);&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;State:= 0;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />END_CASE<br /></code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>