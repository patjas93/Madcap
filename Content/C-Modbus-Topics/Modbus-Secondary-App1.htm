<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="Modbus RTU" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Application On The Secondary Device Side</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1>Application On The Secondary Device Side</h1>
                                        <p>The ModbusRTUSlave_xxx function block allows for the creation of a secondary device by specifying variables indicating input, output, and memory areas. At the same time, only one Modbus secondary device can exist on a single RS-bus output. You must call ModbusRTUSlave_xxx function block  in each cycle for proper operation. The function block itself is passive and does not consume CPU time until an external command arrives. In the application, it is necessary to declare and call the appropriate function block for the chosen physical layer, similar to the main device.</p>
                                        <ul>
                                            <li>
                                                <p>ModbusRtuSlave_PcCom – for built-in COM port.</p>
                                            </li>
                                            <li>
                                                <p>ModbusRtuSlave_KL6x22B – for EL6022 terminal.</p>
                                            </li>
                                        </ul>
                                        <p style="text-align: center;">
                                            <img src="../Resources/Images/slave-declare.png" title="Sample declaration of Secondary device function block" alt="Sample declaration of Secondary device function block" style="border-left-style: solid;border-left-width: 1px;border-left-color: ;border-right-style: solid;border-right-width: 1px;border-right-color: ;border-top-style: solid;border-top-width: 1px;border-top-color: ;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: ;" data-mc-target-name="Sample declaration of Secondary device function block" />
                                        </p>
                                        <p class="image-desc" data-mc-xref-target-name="Sample_declaration_of_Secondary_device_function_block"><a name="Sample_declaration_of_Secondary_device_function_block" data-mc-generated-bookmark="ListOf"></a>Sample declaration of Secondary device function block</p>
                                        <p style="text-align: center;">
                                            <img src="../Resources/Images/slave-fb.png" title="Sample call of Secondary device function block" alt="Sample call of Secondary device function block" style="border-left-style: solid;border-left-width: 0px;border-left-color: ;border-right-style: solid;border-right-width: 0px;border-right-color: ;border-top-style: solid;border-top-width: 0px;border-top-color: ;border-bottom-style: solid;border-bottom-width: 0px;border-bottom-color: ;" data-mc-target-name="Sample call of Secondary device function block" />
                                        </p>
                                        <p class="image-desc" data-mc-xref-target-name="Sample_call_of_Secondary_device_function_block"><a name="Sample_call_of_Secondary_device_function_block" data-mc-generated-bookmark="ListOf"></a>Sample call of Secondary device function block</p>
                                        <table style="width: 100%;border-left-style: solid;border-left-width: 1px;border-left-color: ;border-right-style: solid;border-right-width: 1px;border-right-color: ;border-top-style: solid;border-top-width: 1px;border-top-color: ;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: ;margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color" cellspacing="21">
                                            <caption style="text-align: left;">
                                                <label data-mc-xref-target-name="Inputs_description_of_secondary_device_function_block"><a name="Inputs_description_of_secondary_device_function_block" data-mc-generated-bookmark="ListOf"></a> Inputs description of secondary device function block</label>
                                            </caption>
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Input name</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Input type</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Default value</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Range</th>
                                                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UnitID</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">1..247</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Includes the address of the created secondary station.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">AdrInputs</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Indicates the starting address of the inputsarray created for Modbus communication.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">SizeInputBytes</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Size in bytes of the inputsarray created for Modbus communication.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">AdrOutputs</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Indicates the starting address of the outputsarray created for Modbus communication</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">SizeOutputBytes</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Size in bytes of the outputsarray created for Modbus communication.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">AdrMemory</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">UINT</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">0..65535</td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Indicates the starting address of the internal dataarray created for Modbus communication.</td>
                                                </tr>
                                                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">
                                                        <p>SizeMemoryBytes</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">
                                                        <p>UINT</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">
                                                        <p class="table-text">0</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body1">
                                                        <p>0..65535</p>
                                                    </td>
                                                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body1">
                                                        <p>Size in bytes of the internal dataarray created for Modbus communication.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>Sample variables declaration and implementation of secondary device function block:</p>
                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>PROGRAM ModbusSlave&#160;<br />VAR&#160;<br />&#160;&#160;&#160;&#160;arrInput&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ARRAY[0..20] OF WORD;&#160;<br />&#160;&#160;&#160;&#160;arrOutput&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ARRAY[0..20] OF WORD;&#160;<br />&#160;&#160;&#160;&#160;arrMemory&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ARRAY[0..20] OF WORD;&#160;<br />&#160;&#160;&#160;&#160;MB&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: ModbusRtuSlave_PcCOM;&#160;<br />END_VAR<br /><br />MB(<br />&#160;&#160;&#160;&#160;UnitID:=1,&#160;<br />&#160;&#160;&#160;&#160;AdrInputs:= ADR(arrInput),&#160;<br />&#160;&#160;&#160;&#160;SizeInputBytes:=SIZEOF(arrInput),&#160;<br />&#160;&#160;&#160;&#160;AdrOutputs:=ADR(arrOutput),&#160;<br />&#160;&#160;&#160;&#160;SizeOutputBytes:=SIZEOF(arrOutput),&#160;<br />&#160;&#160;&#160;&#160;AdrMemory:=ADR(arrMemory),&#160;<br />&#160;&#160;&#160;&#160;SizeMemoryBytes:=SIZEOF(arrMemory),&#160;<br />&#160;&#160;&#160;&#160;ErrorId=&gt; );</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>